plugins {
    id 'java'
}

group = 'com.micet'
version = '1.1-SNAPSHOT'

// 基础兼容性设置
sourceCompatibility = '1.8'
targetCompatibility = '1.8'

repositories {
    mavenCentral()
    flatDir {
        dirs 'libs'
    }
}

dependencies {
    // 依赖项保持不变
    compileOnly name: 'spigot-1.7.10'
    compileOnly name: 'WorldEdit'
    compileOnly name: 'StrikePractice'
    compileOnly name: 'ProtocolLib 1.7.10'
    compileOnly name: 'ga.strikepractice:strikepractice-api'

    compileOnly 'org.projectlombok:lombok:1.18.24'
    annotationProcessor 'org.projectlombok:lombok:1.18.24'
}

// --- 核心修复：强制编译器输出 Java 8 格式 ---
tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
    // 如果你用的编译环境是 Java 9 以上（比如 IDEA 自带的 Java 17），
    // 必须加上这一句来“降级”输出。
    if (JavaVersion.current().isJava9Compatible()) {
        options.release = 8
    }
}

processResources {
    def props = [version: version]
    inputs.properties props
    filteringCharset 'UTF-8'
    filesMatching('plugin.yml') {
        expand props
    }
}